package types

import (
	"encoding/json"
	"testing"
)

var gameJSON = `{"Game":{"Players":[{"Name":"CPU","Board":{"Dim":10,"Moves":{"0 5":{"Ship":{"Coords":[{"X":0,"Y":5},{"X":1,"Y":5},{"X":2,"Y":5}],"Hits":3},"State":"d"},"1 4":{"Ship":{"Coords":[{"X":1,"Y":4},{"X":2,"Y":4}],"Hits":2},"State":"d"},"1 5":{"Ship":{"Coords":[{"X":0,"Y":5},{"X":1,"Y":5},{"X":2,"Y":5}],"Hits":3},"State":"d"},"2 4":{"Ship":{"Coords":[{"X":1,"Y":4},{"X":2,"Y":4}],"Hits":2},"State":"d"},"2 5":{"Ship":{"Coords":[{"X":0,"Y":5},{"X":1,"Y":5},{"X":2,"Y":5}],"Hits":3},"State":"d"},"3 1":{"Ship":{"Coords":[{"X":3,"Y":1},{"X":4,"Y":1}],"Hits":2},"State":"d"},"4 1":{"Ship":{"Coords":[{"X":3,"Y":1},{"X":4,"Y":1}],"Hits":2},"State":"d"},"4 5":{"Ship":{"Coords":[{"X":4,"Y":5},{"X":5,"Y":5},{"X":6,"Y":5},{"X":7,"Y":5},{"X":8,"Y":5}],"Hits":5},"State":"d"},"5 5":{"Ship":{"Coords":[{"X":4,"Y":5},{"X":5,"Y":5},{"X":6,"Y":5},{"X":7,"Y":5},{"X":8,"Y":5}],"Hits":5},"State":"d"},"6 5":{"Ship":{"Coords":[{"X":4,"Y":5},{"X":5,"Y":5},{"X":6,"Y":5},{"X":7,"Y":5},{"X":8,"Y":5}],"Hits":5},"State":"d"},"6 8":{"Ship":{"Coords":[{"X":6,"Y":8},{"X":7,"Y":8},{"X":8,"Y":8},{"X":9,"Y":8}],"Hits":3},"State":"-"},"7 3":{"Ship":{"Coords":[{"X":7,"Y":3}],"Hits":1},"State":"d"},"7 5":{"Ship":{"Coords":[{"X":4,"Y":5},{"X":5,"Y":5},{"X":6,"Y":5},{"X":7,"Y":5},{"X":8,"Y":5}],"Hits":5},"State":"d"},"7 8":{"Ship":{"Coords":[{"X":6,"Y":8},{"X":7,"Y":8},{"X":8,"Y":8},{"X":9,"Y":8}],"Hits":3},"State":"h"},"8 3":{"Ship":{"Coords":[{"X":8,"Y":3}],"Hits":1},"State":"d"},"8 5":{"Ship":{"Coords":[{"X":4,"Y":5},{"X":5,"Y":5},{"X":6,"Y":5},{"X":7,"Y":5},{"X":8,"Y":5}],"Hits":5},"State":"d"},"8 8":{"Ship":{"Coords":[{"X":6,"Y":8},{"X":7,"Y":8},{"X":8,"Y":8},{"X":9,"Y":8}],"Hits":3},"State":"h"},"9 8":{"Ship":{"Coords":[{"X":6,"Y":8},{"X":7,"Y":8},{"X":8,"Y":8},{"X":9,"Y":8}],"Hits":3},"State":"h"}},"ShipTot":18},"Moves":{"0 0":{"Ship":null,"State":"m"},"0 1":{"Ship":null,"State":"m"},"0 3":{"Ship":null,"State":"m"},"0 6":{"Ship":null,"State":"m"},"0 8":{"Ship":null,"State":"m"},"0 9":{"Ship":null,"State":"d"},"1 0":{"Ship":null,"State":"m"},"1 2":{"Ship":null,"State":"m"},"1 4":{"Ship":null,"State":"m"},"1 6":{"Ship":null,"State":"m"},"1 7":{"Ship":null,"State":"m"},"1 8":{"Ship":null,"State":"d"},"1 9":{"Ship":null,"State":"d"},"2 1":{"Ship":null,"State":"m"},"2 3":{"Ship":null,"State":"m"},"2 5":{"Ship":null,"State":"d"},"2 8":{"Ship":null,"State":"d"},"2 9":{"Ship":null,"State":"d"},"3 0":{"Ship":null,"State":"m"},"3 2":{"Ship":null,"State":"m"},"3 5":{"Ship":null,"State":"d"},"3 8":{"Ship":null,"State":"m"},"3 9":{"Ship":null,"State":"d"},"4 0":{"Ship":null,"State":"m"},"4 1":{"Ship":null,"State":"m"},"4 3":{"Ship":null,"State":"m"},"4 4":{"Ship":null,"State":"d"},"4 5":{"Ship":null,"State":"d"},"4 6":{"Ship":null,"State":"d"},"4 7":{"Ship":null,"State":"d"},"4 9":{"Ship":null,"State":"d"},"5 1":{"Ship":null,"State":"m"},"5 4":{"Ship":null,"State":"m"},"5 7":{"Ship":null,"State":"m"},"5 8":{"Ship":null,"State":"m"},"6 0":{"Ship":null,"State":"m"},"6 2":{"Ship":null,"State":"m"},"6 4":{"Ship":null,"State":"m"},"6 6":{"Ship":null,"State":"m"},"6 7":{"Ship":null,"State":"d"},"7 2":{"Ship":null,"State":"m"},"7 3":{"Ship":null,"State":"m"},"7 5":{"Ship":null,"State":"m"},"7 7":{"Ship":null,"State":"d"},"7 8":{"Ship":null,"State":"m"},"7 9":{"Ship":null,"State":"m"},"8 1":{"Ship":null,"State":"m"},"8 2":{"Ship":null,"State":"m"},"8 5":{"Ship":null,"State":"m"},"8 7":{"Ship":null,"State":"d"},"9 0":{"Ship":null,"State":"m"},"9 3":{"Ship":null,"State":"m"},"9 4":{"Ship":null,"State":"m"},"9 6":{"Ship":null,"State":"m"},"9 8":{"Ship":null,"State":"m"}},"Hits":16},{"Name":"DBX","Board":{"Dim":10,"Moves":{"0 9":{"Ship":{"Coords":[{"X":0,"Y":9},{"X":1,"Y":9},{"X":2,"Y":9},{"X":3,"Y":9},{"X":4,"Y":9}],"Hits":5},"State":"d"},"1 8":{"Ship":{"Coords":[{"X":1,"Y":8},{"X":2,"Y":8}],"Hits":2},"State":"d"},"1 9":{"Ship":{"Coords":[{"X":0,"Y":9},{"X":1,"Y":9},{"X":2,"Y":9},{"X":3,"Y":9},{"X":4,"Y":9}],"Hits":5},"State":"d"},"2 5":{"Ship":{"Coords":[{"X":2,"Y":5},{"X":3,"Y":5}],"Hits":2},"State":"d"},"2 8":{"Ship":{"Coords":[{"X":1,"Y":8},{"X":2,"Y":8}],"Hits":2},"State":"d"},"2 9":{"Ship":{"Coords":[{"X":0,"Y":9},{"X":1,"Y":9},{"X":2,"Y":9},{"X":3,"Y":9},{"X":4,"Y":9}],"Hits":5},"State":"d"},"3 5":{"Ship":{"Coords":[{"X":2,"Y":5},{"X":3,"Y":5}],"Hits":2},"State":"d"},"3 9":{"Ship":{"Coords":[{"X":0,"Y":9},{"X":1,"Y":9},{"X":2,"Y":9},{"X":3,"Y":9},{"X":4,"Y":9}],"Hits":5},"State":"d"},"4 4":{"Ship":{"Coords":[{"X":4,"Y":4},{"X":4,"Y":5},{"X":4,"Y":6},{"X":4,"Y":7}],"Hits":4},"State":"d"},"4 5":{"Ship":{"Coords":[{"X":4,"Y":4},{"X":4,"Y":5},{"X":4,"Y":6},{"X":4,"Y":7}],"Hits":4},"State":"d"},"4 6":{"Ship":{"Coords":[{"X":4,"Y":4},{"X":4,"Y":5},{"X":4,"Y":6},{"X":4,"Y":7}],"Hits":4},"State":"d"},"4 7":{"Ship":{"Coords":[{"X":4,"Y":4},{"X":4,"Y":5},{"X":4,"Y":6},{"X":4,"Y":7}],"Hits":4},"State":"d"},"4 9":{"Ship":{"Coords":[{"X":0,"Y":9},{"X":1,"Y":9},{"X":2,"Y":9},{"X":3,"Y":9},{"X":4,"Y":9}],"Hits":5},"State":"d"},"6 7":{"Ship":{"Coords":[{"X":6,"Y":7},{"X":7,"Y":7},{"X":8,"Y":7}],"Hits":3},"State":"d"},"6 9":{"Ship":{"Coords":[{"X":6,"Y":9}],"Hits":0},"State":"-"},"7 7":{"Ship":{"Coords":[{"X":6,"Y":7},{"X":7,"Y":7},{"X":8,"Y":7}],"Hits":3},"State":"d"},"8 6":{"Ship":{"Coords":[{"X":8,"Y":6}],"Hits":0},"State":"-"},"8 7":{"Ship":{"Coords":[{"X":6,"Y":7},{"X":7,"Y":7},{"X":8,"Y":7}],"Hits":3},"State":"d"}},"ShipTot":18},"Moves":{"0 0":{"Ship":null,"State":"m"},"0 1":{"Ship":null,"State":"m"},"0 4":{"Ship":null,"State":"m"},"0 5":{"Ship":null,"State":"d"},"0 8":{"Ship":null,"State":"m"},"1 0":{"Ship":null,"State":"m"},"1 1":{"Ship":null,"State":"m"},"1 2":{"Ship":null,"State":"m"},"1 3":{"Ship":null,"State":"m"},"1 4":{"Ship":null,"State":"d"},"1 5":{"Ship":null,"State":"d"},"1 6":{"Ship":null,"State":"m"},"1 9":{"Ship":null,"State":"m"},"2 0":{"Ship":null,"State":"m"},"2 1":{"Ship":null,"State":"m"},"2 4":{"Ship":null,"State":"d"},"2 5":{"Ship":null,"State":"d"},"2 7":{"Ship":null,"State":"m"},"3 0":{"Ship":null,"State":"m"},"3 1":{"Ship":null,"State":"d"},"3 5":{"Ship":null,"State":"m"},"3 8":{"Ship":null,"State":"m"},"4 0":{"Ship":null,"State":"m"},"4 1":{"Ship":null,"State":"d"},"4 2":{"Ship":null,"State":"m"},"4 3":{"Ship":null,"State":"m"},"4 4":{"Ship":null,"State":"m"},"4 5":{"Ship":null,"State":"d"},"4 9":{"Ship":null,"State":"m"},"5 0":{"Ship":null,"State":"m"},"5 1":{"Ship":null,"State":"m"},"5 5":{"Ship":null,"State":"d"},"5 6":{"Ship":null,"State":"m"},"5 8":{"Ship":null,"State":"m"},"6 0":{"Ship":null,"State":"m"},"6 1":{"Ship":null,"State":"m"},"6 5":{"Ship":null,"State":"d"},"7 0":{"Ship":null,"State":"m"},"7 1":{"Ship":null,"State":"m"},"7 3":{"Ship":null,"State":"d"},"7 5":{"Ship":null,"State":"d"},"7 7":{"Ship":null,"State":"m"},"7 8":{"Ship":null,"State":"h"},"7 9":{"Ship":null,"State":"m"},"8 0":{"Ship":null,"State":"m"},"8 1":{"Ship":null,"State":"m"},"8 3":{"Ship":null,"State":"d"},"8 5":{"Ship":null,"State":"d"},"8 8":{"Ship":null,"State":"h"},"9 0":{"Ship":null,"State":"m"},"9 1":{"Ship":null,"State":"m"},"9 5":{"Ship":null,"State":"m"},"9 7":{"Ship":null,"State":"m"},"9 8":{"Ship":null,"State":"h"},"9 9":{"Ship":null,"State":"m"}},"Hits":17}]},"GameType":1}`

func TestPrettyPrintGame(t *testing.T) {
	for name, tt := range map[string]struct {
		gameJSON string
		player   int
		expected string
	}{
		"p1": {
			gameJSON: gameJSON,
			player:   1,
		},
		"p2": {
			gameJSON: gameJSON,
			player:   2,
		},
	} {
		t.Run(name, func(t *testing.T) {
			var g Game
			err := json.Unmarshal([]byte(tt.gameJSON), &g)
			if err != nil {
				panic(err)
			}

			actual := g.PrettyPrintGame(tt.player)
			if tt.expected != actual {
				t.Fatalf("Expected \n%s Got \n%s", tt.expected, actual)
			}
		})
	}
}
